<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplicativo de Viagem - Pirapass</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            max-width: 420px;
            width: 100%;
            padding: 2rem;
            text-align: center;
        }
        .screen {
            display: none;
        }
        .screen.active {
            display: block;
        }
        .confirmation-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 1rem 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: none;
            text-align: center;
        }
        .confirmation-message.success {
            background-color: #d1fae5;
            border: 1px solid #34d399;
            color: #065f46;
        }
        .confirmation-message.error {
            background-color: #fee2e2;
            border: 1px solid #f87171;
            color: #991b1b;
        }
    </style>
</head>
<body>

    <div id="welcome-screen" class="container bg-white rounded-3xl shadow-2xl p-8 screen active">
        <h1 class="text-4xl font-extrabold text-blue-600 mb-4">
            Seja bem-vindo ao PiraPass!
        </h1>
        <p class="text-gray-700 text-lg mb-8">
            Seu aplicativo de transporte agendado.
        </p>
        <button id="start-btn" class="bg-blue-600 text-white font-bold py-4 px-8 rounded-full shadow-lg hover:bg-blue-700 transition-transform transform hover:scale-105">
            Bora lá!
        </button>
    </div>

    <div id="choice-screen" class="container bg-white rounded-3xl shadow-2xl p-8 screen">
        <h2 class="text-3xl font-bold text-gray-800 mb-6">
            O que você é?
        </h2>
        <p class="text-gray-600 text-lg mb-8">
            Escolha como você vai usar o nosso aplicativo.
        </p>
        <div class="space-y-4">
            <button id="motorista-btn" class="w-full bg-blue-600 text-white font-bold py-4 px-8 rounded-full shadow-lg hover:bg-blue-700 transition-transform transform hover:scale-105">
                Eu sou motorista
            </button>
            <button id="passageiro-btn" class="w-full bg-green-600 text-white font-bold py-4 px-8 rounded-full shadow-lg hover:bg-green-700 transition-transform transform hover:scale-105">
                Eu sou passageiro
            </button>
        </div>
    </div>
    
    <!-- Tela de agendamento de viagem para o passageiro -->
    <div id="passenger-dashboard" class="container bg-white rounded-3xl shadow-2xl p-8 screen">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">Agendar uma Viagem</h2>
        <p class="text-gray-600 mb-8">Preencha os dados da sua corrida.</p>
        
        <form id="passenger-form" class="space-y-6 text-left">
            <div>
                <label for="passenger-name" class="block text-gray-700 font-medium mb-1">Seu Nome</label>
                <input type="text" id="passenger-name" name="passenger-name" placeholder="Ex: Caio" required
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
            </div>

            <!-- Botão especial para acesso admin, que será exibido via JS -->
            <div id="admin-access" class="hidden">
                <p class="text-sm text-center text-gray-500 mb-2">Acesso de Administrador detectado.</p>
                <button id="admin-login-btn" type="button" class="w-full bg-indigo-600 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-indigo-700 transition-transform transform hover:scale-105">
                    Entrar como Administrador
                </button>
            </div>

            <div>
                <label for="trip-date" class="block text-gray-700 font-medium mb-1">Data</label>
                <input type="date" id="trip-date" name="trip-date" required
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
            </div>
            <div>
                <label for="trip-time" class="block text-gray-700 font-medium mb-1">Hora</label>
                <input type="time" id="trip-time" name="trip-time" required
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
            </div>
            <div>
                <label for="trip-location" class="block text-gray-700 font-medium mb-1">Local de Partida</label>
                <input type="text" id="trip-location" name="trip-location" placeholder="Ex: Rua do Porto" required
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
            </div>
            <div>
                <label for="trip-destination" class="block text-gray-700 font-medium mb-1">Local de Destino</label>
                <input type="text" id="trip-destination" name="trip-destination" placeholder="Ex: Largo da Matriz" required
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
            </div>
            
            <button id="submit-ride-btn" type="submit" class="w-full bg-green-600 text-white font-bold py-4 px-8 rounded-full shadow-lg hover:bg-green-700 transition-transform transform hover:scale-105 mt-6">
                Solicitar Corrida
            </button>
        </form>

        <button id="back-from-passenger-btn" class="mt-4 text-green-600 font-bold hover:underline">
            Voltar
        </button>
    </div>

    <!-- Tela do motorista para ver e aceitar pedidos -->
    <div id="driver-dashboard" class="container bg-white rounded-3xl shadow-2xl p-8 screen">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">Pedidos de Corrida</h2>
        <p class="text-gray-600 mb-8">Aqui estão os pedidos de corrida agendados.</p>
        
        <div id="requests-list" class="space-y-4 text-left">
            <!-- Os pedidos serão injetados aqui via JavaScript -->
            <p id="no-requests-message" class="text-gray-500 text-center">Nenhum pedido de corrida agendado no momento.</p>
        </div>
        
        <button id="back-from-driver-btn" class="mt-4 text-blue-600 font-bold hover:underline">
            Voltar
        </button>
    </div>

    <!-- Tela do Administrador -->
    <div id="admin-dashboard" class="container bg-white rounded-3xl shadow-2xl p-8 screen">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">Painel do Administrador</h2>
        <p class="text-gray-600 mb-8">Gerencie as solicitações de cadastro e corridas.</p>
        
        <div id="admin-requests-list" class="space-y-4 text-left">
            <!-- As informações do administrador serão injetadas aqui -->
            <p id="no-admin-requests-message" class="text-gray-500 text-center">Nenhuma solicitação de usuário pendente.</p>
        </div>
        
        <button id="back-from-admin-btn" class="mt-4 text-blue-600 font-bold hover:underline">
            Voltar
        </button>
    </div>

    <!-- Container para a mensagem de confirmação -->
    <div id="confirmation-message" class="confirmation-message">
        <p id="message-text"></p>
    </div>
    
    <script>
        // Referências para os elementos da tela
        const welcomeScreen = document.getElementById('welcome-screen');
        const choiceScreen = document.getElementById('choice-screen');
        const passengerDashboard = document.getElementById('passenger-dashboard');
        const driverDashboard = document.getElementById('driver-dashboard');
        const adminDashboard = document.getElementById('admin-dashboard');

        const requestsList = document.getElementById('requests-list');
        const adminRequestsList = document.getElementById('admin-requests-list');
        
        const startBtn = document.getElementById('start-btn');
        const motoristaBtn = document.getElementById('motorista-btn');
        const passageiroBtn = document.getElementById('passageiro-btn');

        const passengerForm = document.getElementById('passenger-form');
        const passengerNameInput = document.getElementById('passenger-name');
        const adminAccessDiv = document.getElementById('admin-access');
        const adminLoginBtn = document.getElementById('admin-login-btn');
        const submitRideBtn = document.getElementById('submit-ride-btn');

        const backFromPassengerBtn = document.getElementById('back-from-passenger-btn');
        const backFromDriverBtn = document.getElementById('back-from-driver-btn');
        const backFromAdminBtn = document.getElementById('back-from-admin-btn');
        
        const confirmationMessage = document.getElementById('confirmation-message');
        const messageText = document.getElementById('message-text');

        // Array para simular os pedidos de corrida e solicitações de usuário
        const tripRequests = [];
        const pendingUsers = [];

        // Função para mostrar uma mensagem de feedback
        function showMessage(message, type = 'success') {
            messageText.textContent = message;
            confirmationMessage.classList.remove('success', 'error');
            confirmationMessage.classList.add(type);
            confirmationMessage.style.display = 'block';
            setTimeout(() => {
                confirmationMessage.style.display = 'none';
            }, 3000);
        }

        // Função para mudar a tela ativa
        function switchScreen(activeScreen, inactiveScreen) {
            inactiveScreen.classList.remove('active');
            activeScreen.classList.add('active');
        }

        // Função para renderizar os pedidos na tela do motorista
        function renderTripRequests() {
            requestsList.innerHTML = '';
            
            if (tripRequests.length === 0) {
                requestsList.innerHTML = '<p id="no-requests-message" class="text-gray-500 text-center">Nenhum pedido de corrida agendado no momento.</p>';
            } else {
                tripRequests.forEach((request, index) => {
                    const requestCard = document.createElement('div');
                    requestCard.className = 'bg-gray-100 rounded-lg p-4 shadow-md';
                    requestCard.innerHTML = `
                        <p class="font-bold text-gray-800">Passageiro: <span class="font-normal">${request.name}</span></p>
                        <p class="font-bold text-gray-800">Partida: <span class="font-normal">${request.location}</span></p>
                        <p class="font-bold text-gray-800">Destino 🗺️: <span class="font-normal">${request.destination}</span></p>
                        <p class="font-bold text-gray-800">Data: <span class="font-normal">${request.date}</span></p>
                        <p class="font-bold text-gray-800">Hora: <span class="font-normal">${request.time}</span></p>
                        <div class="mt-4 flex space-x-2">
                            <button class="accept-btn bg-green-500 text-white font-bold py-2 px-4 rounded-full hover:bg-green-600 transition-colors" data-index="${index}">Aceitar</button>
                            <button class="decline-btn bg-red-500 text-white font-bold py-2 px-4 rounded-full hover:bg-red-600 transition-colors" data-index="${index}">Recusar</button>
                        </div>
                    `;
                    requestsList.appendChild(requestCard);
                });

                // Adicionar listeners para os botões "Aceitar" e "Recusar"
                document.querySelectorAll('.accept-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const index = e.target.getAttribute('data-index');
                        const acceptedRequest = tripRequests.splice(index, 1);
                        showMessage('Você aceitou a corrida!', 'success');
                        console.log('Corrida aceita:', acceptedRequest);
                        renderTripRequests();
                    });
                });

                document.querySelectorAll('.decline-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const index = e.target.getAttribute('data-index');
                        const declinedRequest = tripRequests.splice(index, 1);
                        showMessage('Você recusou a corrida.', 'error');
                        console.log('Corrida recusada:', declinedRequest);
                        renderTripRequests();
                    });
                });
            }
        }
        
        // Função para renderizar as solicitações na tela do administrador
        function renderAdminDashboard() {
            adminRequestsList.innerHTML = '';
            
            if (pendingUsers.length === 0) {
                adminRequestsList.innerHTML = '<p id="no-admin-requests-message" class="text-gray-500 text-center">Nenhuma solicitação de usuário pendente.</p>';
            } else {
                pendingUsers.forEach((user, index) => {
                    const userCard = document.createElement('div');
                    userCard.className = 'bg-gray-100 rounded-lg p-4 shadow-md';
                    userCard.innerHTML = `
                        <p class="font-bold text-gray-800">Nome: <span class="font-normal">${user.name}</span></p>
                        <p class="font-bold text-gray-800">Tipo: <span class="font-normal">${user.type}</span></p>
                        <div class="mt-4 flex space-x-2">
                            <button class="approve-btn bg-green-500 text-white font-bold py-2 px-4 rounded-full hover:bg-green-600 transition-colors" data-index="${index}">Aprovar</button>
                            <button class="reject-btn bg-red-500 text-white font-bold py-2 px-4 rounded-full hover:bg-red-600 transition-colors" data-index="${index}">Rejeitar</button>
                        </div>
                    `;
                    adminRequestsList.appendChild(userCard);
                });

                document.querySelectorAll('.approve-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const index = e.target.getAttribute('data-index');
                        const approvedUser = pendingUsers.splice(index, 1);
                        showMessage(`Usuário ${approvedUser[0].name} aprovado!`, 'success');
                        renderAdminDashboard();
                    });
                });

                document.querySelectorAll('.reject-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const index = e.target.getAttribute('data-index');
                        const rejectedUser = pendingUsers.splice(index, 1);
                        showMessage(`Usuário ${rejectedUser[0].name} rejeitado.`, 'error');
                        renderAdminDashboard();
                    });
                });
            }
        }

        // Listener de evento para o botão "Bora lá!"
        startBtn.addEventListener('click', () => {
            switchScreen(choiceScreen, welcomeScreen);
        });

        // Listener para o botão "Eu sou motorista"
        motoristaBtn.addEventListener('click', () => {
            switchScreen(driverDashboard, choiceScreen);
            renderTripRequests(); // Atualiza a lista de pedidos quando a tela é ativada
        });
        
        // Listener para o botão "Eu sou passageiro"
        passageiroBtn.addEventListener('click', () => {
            switchScreen(passengerDashboard, choiceScreen);
        });

        // Listeners para os botões "Voltar"
        backFromPassengerBtn.addEventListener('click', () => {
            switchScreen(choiceScreen, passengerDashboard);
        });
        
        backFromDriverBtn.addEventListener('click', () => {
            switchScreen(choiceScreen, driverDashboard);
        });

        backFromAdminBtn.addEventListener('click', () => {
            switchScreen(choiceScreen, adminDashboard);
        });

        // Listener de evento para o envio do formulário de passageiro
        passengerForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const passengerName = passengerNameInput.value;
            const date = document.getElementById('trip-date').value;
            const time = document.getElementById('trip-time').value;
            const location = document.getElementById('trip-location').value;
            const destination = document.getElementById('trip-destination').value;

            // Esta é a parte que agora tem o atalho
            if (passengerName === 'caiquecaetano') {
                switchScreen(adminDashboard, passengerDashboard);
                renderAdminDashboard();
                return;
            }

            const newRequest = { name: passengerName, date, time, location, destination, status: 'pending' };
            tripRequests.push(newRequest);
            
            console.log("Pedido de corrida enviado:", newRequest);
            showMessage("Sua corrida foi solicitada com sucesso!", 'success');
            
            setTimeout(() => {
                switchScreen(choiceScreen, passengerDashboard);
            }, 3000); // Dá tempo para a mensagem aparecer antes de voltar
        });

        // Novo listener para detectar a digitação e mostrar o botão admin
        passengerNameInput.addEventListener('input', () => {
            if (passengerNameInput.value === 'caiquecaetano') {
                adminAccessDiv.classList.remove('hidden');
                submitRideBtn.classList.add('hidden');
            } else {
                adminAccessDiv.classList.add('hidden');
                submitRideBtn.classList.remove('hidden');
            }
        });

        // Listener para o novo botão de login admin
        adminLoginBtn.addEventListener('click', () => {
            switchScreen(adminDashboard, passengerDashboard);
            renderAdminDashboard();
        });
    </script>

</body>
</html>
